"use strict";(self.webpackChunkmultimart_frontend=self.webpackChunkmultimart_frontend||[]).push([[958],{6958:(N,u,p)=>{p.r(u),p.d(u,{ProductDetailComponent:()=>V});var c=p(177),d=p(9417),e=p(4438),g=p(8516);function f(i,s){1&i&&e.nrm(0,"lucide-icon",8)}function v(i,s){if(1&i){const t=e.RV6();e.j41(0,"span",4),e.bIt("mouseover",function(){const n=e.eBV(t).index,o=e.XpG();return e.Njj(o.interactive&&o.onHover(n+1))})("mouseleave",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.interactive&&n.onLeave())})("click",function(){const n=e.eBV(t).index,o=e.XpG();return e.Njj(o.interactive&&o.onClick(n+1))}),e.j41(1,"div",5),e.nrm(2,"lucide-icon",6),e.DNE(3,f,1,0,"lucide-icon",7),e.k0s()()}if(2&i){const t=s.$implicit;e.R7$(2),e.AVh("filled",t.filled)("half-filled",t.halfFilled)("hovered",t.hovered),e.R7$(),e.Y8G("ngIf",t.halfFilled)}}function h(i,s){if(1&i&&(e.j41(0,"span",9),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Lme(" ",t.displayRating," ",t.showCount?"("+t.ratingCount+")":""," ")}}let m=(()=>{class i{constructor(){this.rating=0,this.ratingCount=0,this.interactive=!0,this.showRating=!0,this.showCount=!0,this.ratingChange=new e.bkB,this.stars=Array(5).fill(null).map(()=>({filled:!1,halfFilled:!1,hovered:!1})),this.hoveredRating=0}ngOnInit(){this.updateStars()}ngOnChanges(){this.updateStars()}onClick(t){this.interactive&&(this.rating=t,this.updateStars(),this.ratingChange.emit(t))}onHover(t){this.interactive&&(this.hoveredRating=t,this.updateStars(!0))}onLeave(){this.interactive&&(this.hoveredRating=0,this.updateStars())}updateStars(t=!1){const r=t?this.hoveredRating:this.rating;this.stars.forEach((n,o)=>{const l=o+1,a=l-r;n.filled=l<=Math.floor(r),n.halfFilled=!n.filled&&a<=.5&&a>0,n.hovered=t&&l<=this.hoveredRating})}get displayRating(){return this.rating.toFixed(1)}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-star-rating"]],inputs:{rating:"rating",ratingCount:"ratingCount",interactive:"interactive",showRating:"showRating",showCount:"showCount"},outputs:{ratingChange:"ratingChange"},standalone:!0,features:[e.OA$,e.aNF],decls:4,vars:4,consts:[[1,"star-rating"],[1,"stars"],["class","star-wrapper",3,"mouseover","mouseleave","click",4,"ngFor","ngForOf"],["class","rating-text",4,"ngIf"],[1,"star-wrapper",3,"mouseover","mouseleave","click"],[1,"star-container"],["name","star"],["name","star","class","half-star filled",4,"ngIf"],["name","star",1,"half-star","filled"],[1,"rating-text"]],template:function(r,n){1&r&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,v,4,7,"span",2),e.k0s(),e.DNE(3,h,2,2,"span",3),e.k0s()),2&r&&(e.R7$(),e.AVh("disabled",!n.interactive),e.R7$(),e.Y8G("ngForOf",n.stars),e.R7$(),e.Y8G("ngIf",n.showRating))},dependencies:[c.MD,c.Sq,c.bT,g.flO,g.WGl],styles:[".star-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.stars[_ngcontent-%COMP%]{display:flex;gap:.25rem}.star-wrapper[_ngcontent-%COMP%]{cursor:pointer;display:inline-flex}.disabled[_ngcontent-%COMP%]   .star-wrapper[_ngcontent-%COMP%]{cursor:default}.star-container[_ngcontent-%COMP%]{position:relative;display:inline-flex}lucide-icon[_ngcontent-%COMP%]{width:24px;height:24px;stroke:#d4d4d4;stroke-width:1.5;transition:all .2s ease;fill:transparent;&:hover{transform:scale(1.1)}}lucide-icon.filled[_ngcontent-%COMP%]{stroke:gold;fill:gold;filter:drop-shadow(0 0 2px rgba(255,215,0,.3))}lucide-icon.half-filled[_ngcontent-%COMP%]{position:relative}.half-star[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:12px;overflow:hidden;stroke:gold;fill:gold;filter:drop-shadow(0 0 2px rgba(255,215,0,.3))}lucide-icon.hovered[_ngcontent-%COMP%]{transform:scale(1.1);stroke:gold;fill:gold;filter:drop-shadow(0 0 4px rgba(255,215,0,.5))}.rating-text[_ngcontent-%COMP%]{font-size:.9rem;color:#666}"]})}}return i})();function _(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",22)(1,"img",23),e.bIt("click",function(){const n=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.openImageModal("http://localhost:3000/"+n))})("error",function(n){e.eBV(t);const o=e.XpG(3);return e.Njj(o.onImageError(n))}),e.k0s()()}if(2&i){const t=s.$implicit;e.R7$(),e.Y8G("src","http://localhost:3000/"+t,e.B4B)}}function w(i,s){if(1&i&&(e.j41(0,"div",20),e.DNE(1,_,2,1,"div",21),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngForOf",t.images)}}function C(i,s){1&i&&(e.j41(0,"span",24),e.EFF(1," \u2713 Verified Purchase "),e.k0s())}function b(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),e.nrm(5,"img",7),e.k0s(),e.j41(6,"div",8)(7,"div",9)(8,"span",10),e.EFF(9),e.k0s(),e.nrm(10,"app-star-rating",11),e.k0s(),e.j41(11,"span",12),e.EFF(12),e.nI1(13,"date"),e.k0s()()()()(),e.j41(14,"div",13)(15,"p",14),e.EFF(16),e.k0s(),e.DNE(17,w,2,1,"div",15),e.j41(18,"div",16)(19,"div",17),e.DNE(20,C,2,0,"span",18),e.k0s(),e.j41(21,"button",19),e.bIt("click",function(){const n=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.onHelpfulClick(n))}),e.EFF(22),e.k0s()()()()}if(2&i){const t=s.$implicit;e.R7$(5),e.Y8G("src",t.user.avatar||"assets/default-avatar.png",e.B4B)("alt",t.user.name),e.R7$(4),e.JRh(t.user.name),e.R7$(),e.Y8G("rating",t.rating)("interactive",!1)("showCount",!1),e.R7$(2),e.JRh(e.i5U(13,11,t.createdAt,"MMM dd, yyyy")),e.R7$(4),e.JRh(t.comment),e.R7$(),e.Y8G("ngIf",null==t.images?null:t.images.length),e.R7$(3),e.Y8G("ngIf",t.isVerifiedPurchase),e.R7$(2),e.SpI(" Helpful (",t.helpfulCount||0,") ")}}let R=(()=>{class i{constructor(){this.reviews=[]}openImageModal(t){window.open(t,"_blank")}onImageError(t){t.target.src="assets/image-placeholder.png",t.target.classList.add("error")}onHelpfulClick(t){console.log("Marked as helpful:",t._id)}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-review-list"]],inputs:{reviews:"reviews"},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[[1,"reviews-container"],["class","review-card",4,"ngFor","ngForOf"],[1,"review-card"],[1,"review-header"],[1,"user-info"],[1,"avatar-name"],[1,"user-avatar"],[3,"src","alt"],[1,"user-details"],[1,"name-rating"],[1,"user-name"],[3,"rating","interactive","showCount"],[1,"review-date"],[1,"review-content"],[1,"review-comment"],["class","review-images",4,"ngIf"],[1,"review-footer"],[1,"review-badges"],["class","verified-badge",4,"ngIf"],[1,"helpful-btn",3,"click"],[1,"review-images"],["class","review-image-container",4,"ngFor","ngForOf"],[1,"review-image-container"],["alt","Review photo",1,"review-image",3,"click","error","src"],[1,"verified-badge"]],template:function(r,n){1&r&&(e.j41(0,"div",0),e.DNE(1,b,23,14,"div",1),e.k0s()),2&r&&(e.R7$(),e.Y8G("ngForOf",n.reviews))},dependencies:[c.MD,c.Sq,c.bT,c.vh,m,g.flO],styles:[".reviews-container[_ngcontent-%COMP%]{margin-top:2rem}.review-card[_ngcontent-%COMP%]{padding:2rem;border:1px solid #e5e7eb;border-radius:12px;margin-bottom:1.5rem;background:#fff;box-shadow:0 1px 3px #0000000d;transition:box-shadow .2s ease}.review-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #00000012}.review-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.user-info[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.avatar-name[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.user-avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;overflow:hidden;border:2px solid #f3f4f6}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.name-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-name[_ngcontent-%COMP%]{font-weight:600;color:#111827;font-size:1.05rem}.review-date[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.review-content[_ngcontent-%COMP%]{padding-left:calc(48px + 1rem)}.review-comment[_ngcontent-%COMP%]{margin:1rem 0;line-height:1.7;color:#374151;font-size:.95rem}.review-images[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;margin:1.5rem 0}.review-image-container[_ngcontent-%COMP%]{position:relative;width:140px;height:140px;border-radius:8px;overflow:hidden;box-shadow:0 2px 4px #00000014;transition:transform .2s ease}.review-image-container[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.review-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;cursor:pointer;transition:transform .3s ease}.review-image-container[_ngcontent-%COMP%]:hover   .review-image[_ngcontent-%COMP%]{transform:scale(1.08)}.review-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1.5rem;padding-top:1rem;border-top:1px solid #f3f4f6}.verified-badge[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#065f46;padding:.375rem .75rem;border-radius:9999px;font-size:.875rem;font-weight:500;display:inline-flex;align-items:center;gap:.25rem}.helpful-btn[_ngcontent-%COMP%]{background:#f9fafb;border:1px solid #e5e7eb;padding:.5rem 1rem;border-radius:6px;color:#4b5563;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease}.helpful-btn[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;border-color:#d1d5db}"]})}}return i})();function F(i,s){if(1&i&&(e.j41(0,"span",14),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.selectedFiles.length," photo(s) selected ")}}function x(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",17),e.nrm(1,"img",18),e.j41(2,"button",19),e.bIt("click",function(){const n=e.eBV(t).index,o=e.XpG(2);return e.Njj(o.removeFile(n))}),e.EFF(3,"\xd7"),e.k0s()()}if(2&i){const t=s.index,r=e.XpG(2);e.R7$(),e.Y8G("src",r.previewUrls[t],e.B4B)}}function k(i,s){if(1&i&&(e.j41(0,"div",15),e.DNE(1,x,4,1,"div",16),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.selectedFiles)}}let P=(()=>{class i{constructor(){this.reviewSubmit=new e.bkB,this.rating=0,this.comment="",this.selectedFiles=[],this.previewUrls=[],this.submitting=!1}onRatingChange(t){this.rating=t}onFileSelected(t){const r=t.target;if(r.files){const o=Array.from(r.files).filter(l=>l.type.startsWith("image/"));this.selectedFiles=[...this.selectedFiles,...o].slice(0,5),this.updatePreviews()}}removeFile(t){this.selectedFiles.splice(t,1),this.previewUrls.splice(t,1)}updatePreviews(){this.previewUrls=[],this.selectedFiles.forEach(t=>{const r=new FileReader;r.onload=n=>{this.previewUrls.push(n.target.result)},r.readAsDataURL(t)})}onSubmit(){!this.isValid||this.submitting||(this.submitting=!0,this.reviewSubmit.emit({rating:this.rating,comment:this.comment.trim(),files:this.selectedFiles}))}get isValid(){return this.rating>0}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-review-form"]],inputs:{productId:"productId"},outputs:{reviewSubmit:"reviewSubmit"},standalone:!0,features:[e.aNF],decls:25,vars:7,consts:[["fileInput",""],[1,"review-form"],[1,"rating-section"],[3,"ratingChange","rating","showRating"],[1,"form-group"],["for","review-text"],["id","review-text","rows","4","placeholder","Share your experience with this product...",1,"review-textarea",3,"ngModelChange","ngModel"],[1,"photo-upload"],["type","file","multiple","","accept","image/*",1,"file-input",3,"change"],["type","button",1,"upload-btn",3,"click"],["class","file-info",4,"ngIf"],["class","photo-previews",4,"ngIf"],[1,"form-actions"],["type","button",1,"submit-btn",3,"click","disabled"],[1,"file-info"],[1,"photo-previews"],["class","preview-item",4,"ngFor","ngForOf"],[1,"preview-item"],["alt","Preview",3,"src"],["type","button",1,"remove-btn",3,"click"]],template:function(r,n){if(1&r){const o=e.RV6();e.j41(0,"div",1)(1,"h3"),e.EFF(2,"Write a Review"),e.k0s(),e.j41(3,"div",2)(4,"label"),e.EFF(5,"Overall Rating"),e.k0s(),e.j41(6,"app-star-rating",3),e.bIt("ratingChange",function(a){return e.eBV(o),e.Njj(n.onRatingChange(a))}),e.k0s()(),e.j41(7,"div",4)(8,"label",5),e.EFF(9,"Your Review"),e.k0s(),e.j41(10,"textarea",6),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(n.comment,a)||(n.comment=a),e.Njj(a)}),e.EFF(11,"        "),e.k0s()(),e.j41(12,"div",4)(13,"label"),e.EFF(14,"Add Photos"),e.k0s(),e.j41(15,"div",7)(16,"input",8,0),e.bIt("change",function(a){return e.eBV(o),e.Njj(n.onFileSelected(a))}),e.k0s(),e.j41(18,"button",9),e.bIt("click",function(){e.eBV(o);const a=e.sdS(17);return e.Njj(a.click())}),e.EFF(19," Choose Photos "),e.k0s(),e.DNE(20,F,2,1,"span",10),e.k0s(),e.DNE(21,k,2,1,"div",11),e.k0s(),e.j41(22,"div",12)(23,"button",13),e.bIt("click",function(){return e.eBV(o),e.Njj(n.onSubmit())}),e.EFF(24),e.k0s()()()}2&r&&(e.R7$(6),e.Y8G("rating",n.rating)("showRating",!1),e.R7$(4),e.R50("ngModel",n.comment),e.R7$(10),e.Y8G("ngIf",n.selectedFiles.length),e.R7$(),e.Y8G("ngIf",n.selectedFiles.length),e.R7$(2),e.Y8G("disabled",!n.isValid||n.submitting),e.R7$(),e.SpI(" ",n.submitting?"Submitting...":"Submit Review"," "))},dependencies:[c.MD,c.Sq,c.bT,d.YN,d.me,d.BC,d.vS,m],styles:[".review-form[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #e0e0e0;border-radius:8px}.rating-section[_ngcontent-%COMP%]{margin:1rem 0}.form-group[_ngcontent-%COMP%]{margin:1.5rem 0}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.review-textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e0e0e0;border-radius:4px;resize:vertical;min-height:100px}.photo-upload[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.file-input[_ngcontent-%COMP%]{display:none}.upload-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:#f5f5f5;border:1px solid #e0e0e0;border-radius:4px;cursor:pointer;transition:all .2s}.upload-btn[_ngcontent-%COMP%]:hover{background-color:#eee}.file-info[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.photo-previews[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;margin-top:1rem}.preview-item[_ngcontent-%COMP%]{position:relative;width:100px;height:100px}.preview-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:4px}.remove-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;width:20px;height:20px;border-radius:50%;background:#f44;color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;line-height:1}.submit-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer;font-weight:500;transition:all .2s}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#43a047}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}"]})}}return i})();var M=p(3326),j=p(6241),O=p(6868);var I=p(1626);let $=(()=>{class i{constructor(t){this.http=t,this.apiUrl="/api/api/reviews"}getProductReviews(t){return this.http.get(`${this.apiUrl}/product/${t}`)}createReview(t,r,n){const o=new FormData;return o.append("product",t),o.append("rating",r.rating.toString()),o.append("comment",r.comment),n&&n.forEach((l,a)=>{o.append("images",l,`review-image-${a}`)}),this.http.post(this.apiUrl,o)}deleteReview(t){return this.http.delete(`${this.apiUrl}/${t}`)}markHelpful(t){return this.http.post(`${this.apiUrl}/${t}/helpful`,{})}static{this.\u0275fac=function(r){return new(r||i)(e.KVO(I.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function S(i,s){1&i&&(e.j41(0,"div",7),e.EFF(1,"Loading..."),e.k0s())}function G(i,s){if(1&i&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.HbH(t.messageClass),e.R7$(),e.JRh(t.message)}}function E(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",8)(1,"div"),e.nrm(2,"img",9),e.k0s(),e.j41(3,"div")(4,"h1"),e.EFF(5),e.k0s(),e.j41(6,"p",10),e.EFF(7),e.k0s(),e.j41(8,"div",11),e.EFF(9),e.k0s(),e.j41(10,"div",12),e.nrm(11,"app-star-rating",13),e.j41(12,"span"),e.EFF(13),e.nI1(14,"number"),e.k0s()(),e.j41(15,"div",14),e.nrm(16,"lucide-icon",15),e.j41(17,"span"),e.EFF(18),e.k0s()(),e.j41(19,"div",16)(20,"label"),e.EFF(21,"Quantity: "),e.k0s(),e.j41(22,"input",17),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG();return e.DH7(o.quantity,n)||(o.quantity=n),e.Njj(n)}),e.k0s(),e.j41(23,"button",18),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addToCart())}),e.nrm(24,"lucide-icon",19),e.EFF(25," Add to Cart "),e.k0s()(),e.DNE(26,G,2,3,"div",20),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(2),e.Y8G("src",t.product.images[0]||"https://via.placeholder.com/500",e.B4B)("alt",t.product.name),e.R7$(3),e.JRh(t.product.name),e.R7$(2),e.JRh(t.product.description),e.R7$(2),e.SpI(" \u20b9",t.product.discountPrice||t.product.price," "),e.R7$(2),e.Y8G("rating",t.product.rating)("interactive",!1),e.R7$(2),e.E5c("",e.i5U(14,15,t.product.rating,"1.1-1")," (",t.product.numReviews," ",1===t.product.numReviews?"review":"reviews",")"),e.R7$(5),e.SpI("Stock: ",t.product.stock," units available"),e.R7$(4),e.R50("ngModel",t.quantity),e.Y8G("max",t.product.stock),e.R7$(),e.Y8G("disabled",0===t.product.stock),e.R7$(3),e.Y8G("ngIf",t.message)}}function T(i,s){if(1&i&&(e.j41(0,"div",21)(1,"div",22),e.nrm(2,"app-star-rating",23),e.j41(3,"span",24),e.EFF(4),e.k0s()()()),2&i){const t=e.XpG();e.R7$(2),e.Y8G("rating",t.product.rating)("ratingCount",t.product.numReviews)("interactive",!1),e.R7$(2),e.SpI("Based on ",t.product.numReviews," reviews")}}function D(i,s){if(1&i){const t=e.RV6();e.j41(0,"app-review-form",25),e.bIt("reviewSubmit",function(n){e.eBV(t);const o=e.XpG();return e.Njj(o.onReviewSubmit(n))}),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("productId",null==t.product?null:t.product._id)}}let V=(()=>{class i{constructor(t,r,n,o){this.route=t,this.productService=r,this.cartService=n,this.reviewService=o,this.product=null,this.loading=!1,this.quantity=1,this.message="",this.messageClass="",this.reviews=[],this.showReviewForm=!1}ngOnInit(){this.loadProduct(this.route.snapshot.params.id)}loadProduct(t){this.loading=!0,this.productService.getProduct(t).subscribe({next:r=>{this.product=r.data,this.loading=!1,this.loadReviews(t),this.checkCanReview()},error:()=>this.loading=!1})}loadReviews(t){this.reviewService.getProductReviews(t).subscribe({next:r=>{r.success&&Array.isArray(r.data)&&(this.reviews=r.data)},error:r=>console.error("Error loading reviews:",r)})}checkCanReview(){this.showReviewForm=!0}onReviewSubmit(t){this.product?._id&&this.reviewService.createReview(this.product._id,{rating:t.rating,comment:t.comment},t.files).subscribe({next:r=>{r.success&&(this.product&&(this.product.numReviews=(this.product.numReviews||0)+1,this.product.rating=(this.product.rating*(this.product.numReviews-1)+t.rating)/this.product.numReviews),this.loadReviews(this.product._id),this.showReviewForm=!1)},error:r=>{console.error("Error submitting review:",r),this.message="Failed to submit review. Please try again.",this.messageClass="alert alert-error"}})}addToCart(){this.product&&this.cartService.addToCart(this.product._id,this.quantity).subscribe({next:()=>{this.message="Product added to cart!",this.messageClass="alert alert-success",setTimeout(()=>this.message="",3e3)},error:()=>{this.message="Failed to add to cart",this.messageClass="alert alert-error"}})}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(M.nX),e.rXU(j.b),e.rXU(O.m),e.rXU($))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-product-detail"]],standalone:!0,features:[e.aNF],decls:9,vars:5,consts:[[1,"container",2,"margin-top","2rem"],["class","loading",4,"ngIf"],["style","display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;",4,"ngIf"],[1,"reviews-section"],["class","reviews-summary",4,"ngIf"],[3,"productId","reviewSubmit",4,"ngIf"],[3,"reviews"],[1,"loading"],[2,"display","grid","grid-template-columns","1fr 1fr","gap","2rem"],[2,"width","100%","border-radius","8px",3,"src","alt"],[2,"font-size","1.1rem","margin","1rem 0"],[1,"product-price",2,"font-size","2rem","margin","1rem 0"],[1,"rating-container"],[3,"rating","interactive"],[1,"stock-info"],["name","package",1,"package-icon"],[2,"margin","2rem 0"],["type","number","min","1",1,"form-control",2,"width","80px","margin","0 1rem",3,"ngModelChange","ngModel","max"],[1,"btn","btn-primary",3,"click","disabled"],["name","shopping-cart",2,"width","18px","height","18px","margin-right","0.5rem"],[3,"class",4,"ngIf"],[1,"reviews-summary"],[1,"overall-rating"],[3,"rating","ratingCount","interactive"],[1,"rating-count"],[3,"reviewSubmit","productId"]],template:function(r,n){1&r&&(e.j41(0,"div",0),e.DNE(1,S,2,0,"div",1)(2,E,27,18,"div",2),e.j41(3,"div",3)(4,"h2"),e.EFF(5,"Customer Reviews"),e.k0s(),e.DNE(6,T,5,4,"div",4)(7,D,1,1,"app-review-form",5),e.nrm(8,"app-review-list",6),e.k0s()()),2&r&&(e.R7$(),e.Y8G("ngIf",n.loading),e.R7$(),e.Y8G("ngIf",n.product),e.R7$(4),e.Y8G("ngIf",n.product),e.R7$(),e.Y8G("ngIf",n.showReviewForm),e.R7$(),e.Y8G("reviews",n.reviews))},dependencies:[c.MD,c.bT,c.QX,d.YN,d.me,d.Q0,d.BC,d.VZ,d.zX,d.vS,g.flO,g.WGl,m,R,P],styles:[".rating-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:1rem 0;font-size:1rem}.star-icon[_ngcontent-%COMP%]{width:20px;height:20px;stroke:#f39c12;fill:#f39c12;stroke-width:2}.stock-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:1rem 0;color:#27ae60}.package-icon[_ngcontent-%COMP%]{width:20px;height:20px;stroke-width:2}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center}.reviews-section[_ngcontent-%COMP%]{margin-top:3rem;padding-top:2rem;border-top:1px solid #e0e0e0}.reviews-summary[_ngcontent-%COMP%]{margin:1.5rem 0;padding:1.5rem;background-color:#f9f9f9;border-radius:8px}.overall-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.rating-count[_ngcontent-%COMP%]{color:#666;font-size:.9rem}"]})}}return i})()}}]);